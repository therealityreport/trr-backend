# Repository Structure

This folder documents the TRR-Backend repository structure and architecture.

## Generated Documentation

Auto-generated by CI (weekly) and `make repo-map`:

- [REPO_STRUCTURE.md](generated/REPO_STRUCTURE.md) - Directory tree listing *
- [REPO_STRUCTURE.mermaid.md](generated/REPO_STRUCTURE.mermaid.md) - Visual structure diagram (Mermaid) * **
- [CODE_IMPORT_GRAPH.md](generated/CODE_IMPORT_GRAPH.md) - Internal import dependencies (Tree-sitter)
- [SCRIPTS_FLOW.md](generated/SCRIPTS_FLOW.md) - Script entrypoints and dependencies (Tree-sitter)

\* *Generated by the Repository Map workflow; may not exist until the first workflow run.*
\*\* *Complex diagram may not render in GitHub's Mermaid viewer; download the rendered SVG artifact from the workflow run.*

## Curated Diagrams

Stable template diagrams (auto-generated but manually curated):

- [diagrams/git_workflow.md](diagrams/git_workflow.md) - Git branching strategy
- [diagrams/system_maps.md](diagrams/system_maps.md) - Architecture and data flow diagrams

These diagrams use stable templates and can be manually updated by editing [scripts/generate_repo_mermaid.py](../../scripts/generate_repo_mermaid.py).

## Regenerating Locally

```bash
# Generate Tree-sitter-based code diagrams
make repo-map

# Check if diagrams are up to date
make repo-map-check
```

## CI Updates

The [Repository Map workflow](../../.github/workflows/repo_map.yml) runs weekly (Sunday midnight UTC) and on manual trigger:

1. Generates repo structure using PGSch/graph-git-repo
2. Generates code diagrams using Tree-sitter
3. Opens a PR with any changes

## Generated vs Hand-Authored

| Type | Location | Updated By |
|------|----------|------------|
| Generated | `generated/` | CI workflow + `make repo-map` |
| Hand-authored | `diagrams/` | Manual edits only |

**Rule:** Never manually edit files in `generated/` - they will be overwritten.
